<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmic Encounter Alien Manager</title>
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="shortcut icon" href="favicon.ico">
    <link rel="manifest" href="site.webmanifest">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    <style>
        :root {
            --bg-color: #0b0d17;
            --card-bg: #15192b;
            --text-main: #e0e6ed;
            --text-muted: #94a3b8;
            --accent: #facc15;
            --border: #2d3748;
            --c-green: #22c55e;
            --c-yellow: #eab308;
            --c-red: #ef4444;
            --c-purple: #a855f7;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            padding-top: 0;
        }

        header {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            padding: 15px 20px;
            background: rgba(21, 25, 43, 0.98);
            border-bottom: 1px solid var(--border);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.7);
            position: sticky;
            top: 0;
            z-index: 1000;
            margin-bottom: 20px;
            transition: transform 0.3s ease-in-out;
        }

        header.header-hidden {
            transform: translateY(-100%);
        }

        .floating-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            display: none;
            align-items: center;
            justify-content: center;
            transition: opacity 0.3s;
        }

        .floating-btn.visible {
            display: flex;
        }

        h1 {
            margin: 0;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 1.8rem;
            text-shadow: 0 0 15px rgba(250, 204, 21, 0.3);
        }

        .controls-row {
            display: flex;
            gap: 10px;
            justify-content: center;
            width: 100%;
            max-width: 900px;
            flex-wrap: wrap;
        }

        .search-wrapper {
            position: relative;
            display: flex;
            flex: 2;
            min-width: 200px;
        }

        .clear-icon {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            color: #94a3b8;
            font-size: 1.2rem;
            display: none;
            user-select: none;
        }

        .clear-icon:hover {
            color: white;
        }

        input[type="text"],
        select,
        button {
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid var(--border);
            font-size: 0.95rem;
            height: 40px;
            box-sizing: border-box;
        }

        input[type="text"] {
            background: #0f121f;
            color: white;
            width: 100%;
            min-width: 200px;
        }

        select {
            background: #0f121f;
            color: white;
            cursor: pointer;
            flex: 1;
            min-width: 150px;
        }

        button {
            background: var(--accent);
            color: #000;
            font-weight: 800;
            cursor: pointer;
            text-transform: uppercase;
            white-space: nowrap;
            flex: 0;
            transition: filter 0.2s;
        }

        button:hover {
            filter: brightness(1.1);
        }

        .filters-row {
            display: flex;
            gap: 20px;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 5px;
            background: rgba(0, 0, 0, 0.3);
            padding: 8px 15px;
            border-radius: 20px;
            border: 1px solid var(--border);
        }

        .filter-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .filter-label {
            font-size: 0.85rem;
            text-transform: uppercase;
            color: var(--text-muted);
            font-weight: bold;
            margin-right: 5px;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            user-select: none;
        }

        .cb-green {
            accent-color: var(--c-green);
        }

        .cb-yellow {
            accent-color: var(--c-yellow);
        }

        .cb-red {
            accent-color: var(--c-red);
        }

        .result-count {
            text-align: center;
            color: var(--text-muted);
            margin-bottom: 20px;
            font-size: 1rem;
            font-weight: 500;
        }

        .result-count span {
            color: var(--accent);
            font-weight: bold;
        }

        @media (max-width: 700px) {
            header {
                padding: 10px;
                gap: 10px;
            }

            h1 {
                font-size: 1.4rem;
            }

            .controls-row {
                flex-direction: column;
                gap: 8px;
            }

            input[type="text"],
            select,
            button {
                width: 100%;
            }

            .filters-row {
                gap: 10px;
                justify-content: center;
            }

            .filter-group {
                flex-wrap: wrap;
                justify-content: center;
            }

            .filter-group.extras {
                border-left: none !important;
                padding-left: 0 !important;
                margin-top: 5px;
                border-top: 1px solid var(--border);
                padding-top: 10px;
                width: 100%;
            }

            .filter-label.extras-label {
                display: none;
            }
        }

        .alien-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            padding-bottom: 40px;
        }

        .card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            position: relative;
        }

        .card:hover {
            transform: translateY(-5px);
            border-color: var(--accent);
        }

        .card-image-container {
            width: 100%;
            height: 220px;
            overflow: hidden;
            position: relative;
            background: #fff;
            border-bottom: 4px solid var(--accent);
        }

        .card-image-container.alt-border {
            border-bottom-color: var(--c-purple);
        }

        .card-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: top center;
        }

        .card-image-title {
            position: absolute;
            top: 0;
            /* Definimos o espa√ßo lateral para n√£o cobrir as lumin√°rias */
            left: 48px;
            right: 50px;
            width: auto;
            /* A largura agora √© autom√°tica baseada no left/right */

            /* Fundo branco chapado */
            background: #fff;

            /* Ajuste de padding interno do texto */
            padding: 2px 5px;

            /* Estilo da fonte */
            text-align: center;
            font-family: 'Impact', 'Arial Black', sans-serif;
            font-size: 1.6rem;
            color: #000;
            text-transform: uppercase;
            letter-spacing: 1px;
            z-index: 10;

            /* Removemos a sombra branca pois agora o fundo j√° √© branco */
            text-shadow: none;

            /* Arredondamento apenas nos cantos inferiores para est√©tica (opcional) */
            border-bottom-left-radius: 8px;
            border-bottom-right-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
            /* Sombra suave para destacar a plaquinha */

            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* Regra espec√≠fica para o t√≠tulo quando o container tem a classe 'alt-border' */
        .card-image-container.alt-border .card-image-title {
            background: #000;
            /* Fundo preto chapado */
            color: #fff;
            /* Texto branco para contraste */
        }

        @media (max-width: 600px) {
            .card-image-title {
                font-size: 1.3rem;
                /* Ajuste para telas menores, mantendo as lumin√°rias vis√≠veis */
                left: 40px;
                right: 40px;
            }

            .alien-grid {
                grid-template-columns: 1fr;
            }
        }

        .badges-container {
            position: absolute;
            bottom: 5px;
            right: 5px;
            display: flex;
            gap: 5px;
            z-index: 10;
        }

        .badge {
            background: rgba(0, 0, 0, 0.8);
            color: #fff;
            padding: 3px 8px;
            font-size: 0.7rem;
            border-radius: 4px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .alert-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
        }

        .expansion-tag {
            position: absolute;
            bottom: 5px;
            left: 5px;
            background: rgba(0, 0, 0, 0.7);
            color: #fff;
            padding: 2px 8px;
            font-size: 0.7rem;
            border-radius: 4px;
            z-index: 5;
        }

        .card-content {
            padding: 20px;
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }

        .aka-info {
            font-size: 0.9rem;
            color: var(--text-muted);
            text-align: center;
            margin-bottom: 10px;
            font-style: italic;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 10px;
        }

        .aka-info strong {
            color: var(--accent);
            text-transform: uppercase;
            font-style: normal;
        }

        .power-summary {
            font-size: 1rem;
            color: var(--accent);
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
        }

        .power-block {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 8px;
            font-size: 0.95rem;
            line-height: 1.5;
            color: #cbd5e1;
            border-left: 2px solid var(--text-muted);
            text-align: justify;
            hyphens: auto;
        }

        .power-block b {
            color: #fff;
            font-weight: 700;
        }

        .action-btn {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-muted);
            margin-top: 10px;
            width: 100%;
            padding: 8px;
            font-size: 0.8rem;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s;
        }

        .action-btn:hover {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-main);
            border-color: var(--text-main);
        }

        .flare-btn {
            border-color: var(--accent);
            color: var(--accent);
            font-weight: bold;
            text-transform: uppercase;
        }

        .flare-btn:hover {
            background: var(--accent);
            color: #000;
        }

        .expandable-text {
            display: none;
            margin-top: 10px;
            font-size: 0.85rem;
            padding: 10px;
            border-radius: 6px;
            text-align: justify;
        }

        .expandable-text.show {
            display: block;
        }

        .flare-text {
            background: rgba(250, 204, 21, 0.1);
            border: 1px solid rgba(250, 204, 21, 0.3);
            color: #e2e8f0;
        }

        .flare-title {
            color: var(--accent);
            font-weight: bold;
            text-transform: uppercase;
            font-size: 0.8rem;
            margin-bottom: 4px;
            margin-top: 10px;
            display: block;
        }

        .flare-title:first-child {
            margin-top: 0;
        }

        .history-text {
            color: #94a3b8;
            font-style: italic;
            border-top: 1px solid var(--border);
        }

        .timing-block {
            margin-top: 10px;
            background: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 6px;
            font-size: 0.85rem;
            border: 1px solid var(--border);
        }

        .timing-header {
            color: var(--text-muted);
            font-weight: bold;
            margin-bottom: 5px;
            display: block;
            text-transform: uppercase;
            font-size: 0.75rem;
        }

        .timing-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
        }

        .timing-value {
            color: var(--text-main);
            font-weight: 500;
        }

        .phases-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 5px;
            margin-top: 8px;
        }

        .phase-tag {
            background: #1e293b;
            color: #64748b;
            padding: 4px;
            text-align: center;
            border-radius: 4px;
            font-size: 0.7rem;
            border: 1px solid #334155;
        }

        .phase-tag.active {
            background: rgba(34, 197, 94, 0.2);
            color: #4ade80;
            border-color: #22c55e;
            font-weight: bold;
        }

        /* Essence Card Styles */
        .essence-btn:hover {
            filter: brightness(1.2);
            color: #fff;
        }

        .essence-text {
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.3);
            color: #e2e8f0;
        }

        .essence-card {
            background: rgba(0, 0, 0, 0.2);
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 4px;
            border-left: 3px solid #8b5cf6;
        }

        .essence-card:last-child {
            margin-bottom: 0;
        }

        .essence-title {
            display: block;
            font-weight: bold;
            color: #a78bfa;
            margin-bottom: 4px;
            font-size: 0.9rem;
        }

        /* Like/Dislike Styles */
        .like-dislike-container {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            justify-content: center;
        }

        .like-btn,
        .dislike-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.2s;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .like-btn:hover,
        .dislike-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .like-btn.active {
            background: rgba(34, 197, 94, 0.2);
            border-color: var(--c-green);
            color: var(--c-green);
        }

        .dislike-btn.active {
            background: rgba(239, 68, 68, 0.2);
            border-color: var(--c-red);
            color: var(--c-red);
        }

        /* Side Menu Styles */
        .menu-btn {
            background: none;
            border: none;
            color: var(--text-main);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px;
            z-index: 1001;
            justify-self: start;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
        }

        .header-row {
            display: grid;
            grid-template-columns: 50px 1fr 50px;
            align-items: center;
            width: 100%;
            position: relative;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.4rem;
                text-align: center;
                grid-column: 2;
                width: 100%;
                margin: 0;
            }
        }

        .side-menu {
            position: fixed;
            top: 0;
            left: -250px;
            width: 250px;
            height: 100%;
            background: var(--card-bg);
            border-right: 1px solid var(--border);
            transition: left 0.3s ease;
            z-index: 2000;
            padding-top: 60px;
            display: flex;
            flex-direction: column;
        }

        .side-menu.open {
            left: 0;
        }

        .menu-item {
            padding: 15px 20px;
            color: var(--text);
            text-decoration: none;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            transition: background 0.2s;
        }

        .menu-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .menu-item.active {
            background: rgba(34, 197, 94, 0.1);
            color: var(--c-green);
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1999;
            display: none;
        }

        .overlay.show {
            display: block;
        }
    </style>
</head>

<body>

    <div id="overlay" class="overlay" onclick="closeMenu()"></div>

    <nav id="sideMenu" class="side-menu">
        <div class="menu-item active" onclick="selectVariant('aliens')">Aliens</div>
        <div class="menu-item" onclick="selectVariant('hazards')">Hazards</div>
        <div class="menu-item" onclick="selectVariant('techs')">Technology</div>
        <div class="menu-item" onclick="selectVariant('stations')">Stations</div>
        <div class="menu-item" onclick="selectVariant('moons')">Moons</div>
        <div class="menu-item" onclick="selectVariant('evolutions')">Evolutions</div>
        <div class="menu-item" onclick="selectVariant('lux')">Lux</div>
        <div class="menu-item" onclick="window.location.href='https://cosmic-odyssey-kappa.vercel.app/'"
            id="menuCampaign">Campanha</div>
    </nav>

    <header>
        <div class="header-row">
            <button class="menu-btn" onclick="toggleMenu()">‚ò∞</button>
            <h1>Cosmic Encounter</h1>
        </div>

        <div class="controls-row">
            <div class="search-wrapper">
                <input type="text" id="searchInput" placeholder="Buscar..." onkeyup="filterCurrentView()">
                <span id="clearSearch" class="clear-icon" onclick="clearSearch()">√ó</span>
            </div>
            <select id="expansionFilter" onchange="filterCurrentView()">
                <option value="all">Todas as Expans√µes</option>
                <option value="Base Game">Base Game</option>
                <option value="Cosmic Incursion">Cosmic Incursion</option>
                <option value="Cosmic Conflict">Cosmic Conflict</option>
                <option value="Cosmic Alliance">Cosmic Alliance</option>
                <option value="Cosmic Storm">Cosmic Storm</option>
                <option value="Cosmic Dominion">Cosmic Dominion</option>
                <option value="Cosmic Eons">Cosmic Eons</option>
                <option value="Cosmic Odyssey">Cosmic Odyssey</option>
                <option value="42nd Anniversary Edition">42nd Anniversary Edition</option>
            </select>
            <button onclick="toggleLanguage()" id="langBtn">üá∫üá∏ English</button>
        </div>

        <div class="filters-row" id="alienFilters">
            <div class="filter-group">
                <span class="filter-label" id="labelAlert">N√≠vel:</span>
                <label class="checkbox-label"><input type="checkbox" class="cb-green" value="green" checked
                        onchange="filterCurrentView()"> üü¢</label>
                <label class="checkbox-label"><input type="checkbox" class="cb-yellow" value="yellow" checked
                        onchange="filterCurrentView()"> üü°</label>
                <label class="checkbox-label"><input type="checkbox" class="cb-red" value="red" checked
                        onchange="filterCurrentView()"> üî¥</label>
            </div>
            <div class="filter-group extras" style="border-left: 1px solid var(--border); padding-left: 15px;">
                <span class="filter-label extras-label">Extras:</span>
                <label class="checkbox-label" title="Com Prepara√ß√£o"><input type="checkbox" id="checkSetup"
                        onchange="filterCurrentView()"> ‚öôÔ∏è <span id="labelSetup">Prepara√ß√£o</span></label>
                <label class="checkbox-label" title="Com Componentes"><input type="checkbox" id="checkComponents"
                        onchange="filterCurrentView()"> üì¶ <span id="labelTokens">Fichas</span></label>
                <label class="checkbox-label" title="Com Cartas de Ess√™ncia"><input type="checkbox" id="checkEssence"
                        onchange="filterCurrentView()"> ‚ú® <span id="labelEssence">Ess√™ncia</span></label>
            </div>
            <div class="filter-group extras" style="border-left: 1px solid var(--border); padding-left: 15px;">
                <span class="filter-label" id="labelPrefs">Prefer√™ncias:</span>
                <label class="checkbox-label"><input type="checkbox" id="checkLiked" onchange="filterCurrentView()">
                    üëç</label>
                <label class="checkbox-label"><input type="checkbox" id="checkDisliked" onchange="filterCurrentView()">
                    üëé</label>
            </div>
        </div>
    </header>

    <div class="container">
        <div id="resultCount" class="result-count"></div>
        <div id="alienGrid" class="alien-grid"></div>
        <div id="hazardGrid" class="alien-grid" style="display: none;"></div>
        <div id="techGrid" class="alien-grid" style="display: none;"></div>
        <div id="stationGrid" class="alien-grid" style="display: none;"></div>
        <div id="moonGrid" class="alien-grid" style="display: none;"></div>
        <div id="evolutionGrid" class="alien-grid" style="display: none;"></div>
        <div id="luxGrid" class="alien-grid" style="display: none;"></div>
    </div>

    <button id="showFiltersBtn" class="floating-btn" onclick="showHeader()">üîç</button>

    <script>window.aliensData = [];</script>

    <script src="images.js" defer></script>
    <script src="aliens_base_game.js" defer></script>
    <script src="aliens_cosmic_incursion.js" defer></script>
    <script src="aliens_cosmic_conflict.js" defer></script>
    <script src="aliens_cosmic_alliance.js" defer></script>
    <script src="aliens_cosmic_storm.js" defer></script>
    <script src="aliens_cosmic_dominion.js" defer></script>
    <script src="aliens_cosmic_eons.js" defer></script>
    <script src="aliens_cosmic_odyssey.js" defer></script>
    <script src="hazards.js" defer></script>
    <script src="techs.js" defer></script>
    <script src="stations.js" defer></script>
    <script src="moons.js" defer></script>
    <script src="evolutions.js" defer></script>
    <script src="lux.js" defer></script>


    <script>
        let currentLang = 'pt';

        // --- METADADOS OFICIAIS FFG ---
        const alienMetadata = {
            // --- BASE GAME (50) ---
            amoeba: { color: 'yellow', comp: false, exp: 'Base Game' }, anti_matter: { color: 'yellow', comp: false, exp: 'Base Game' }, barbarian: { color: 'green', comp: false, exp: 'Base Game' }, calculator: { color: 'yellow', comp: false, exp: 'Base Game' }, chosen: { color: 'green', comp: false, exp: 'Base Game' }, citadel: { color: 'red', comp: true, exp: 'Base Game' }, clone: { color: 'green', comp: false, exp: 'Base Game' }, cudgel: { color: 'green', comp: false, exp: 'Base Game' }, demon: { color: 'yellow', comp: false, exp: '42nd Anniversary Edition' }, dictator: { color: 'red', comp: false, exp: 'Base Game' }, fido: { color: 'yellow', comp: false, exp: 'Base Game' }, filch: { color: 'green', comp: false, exp: 'Base Game' }, fodder: { color: 'yellow', comp: false, exp: 'Base Game' }, gambler: { color: 'red', comp: false, exp: 'Base Game' }, grudge: { color: 'red', comp: true, exp: 'Base Game' }, hacker: { color: 'green', comp: false, exp: 'Base Game' }, hate: { color: 'yellow', comp: false, exp: 'Base Game' }, healer: { color: 'yellow', comp: false, exp: 'Base Game' }, human: { color: 'yellow', comp: false, exp: 'Base Game' }, kamikaze: { color: 'yellow', comp: false, exp: 'Base Game' }, loser: { color: 'green', comp: false, exp: 'Base Game' }, machine: { color: 'red', comp: false, exp: 'Base Game' }, macron: { color: 'green', comp: false, exp: 'Base Game' }, masochist: { color: 'red', comp: false, exp: 'Base Game' }, mind: { color: 'yellow', comp: false, exp: 'Base Game' }, mirror: { color: 'yellow', comp: false, exp: 'Base Game' }, miser: { color: 'green', comp: true, exp: 'Base Game' }, mite: { color: 'yellow', comp: false, exp: 'Base Game' }, mutant: { color: 'green', comp: false, exp: 'Base Game' }, observer: { color: 'green', comp: false, exp: 'Base Game' }, oracle: { color: 'green', comp: false, exp: 'Base Game' }, pacifist: { color: 'green', comp: false, exp: 'Base Game' }, parasite: { color: 'green', comp: false, exp: 'Base Game' }, philanthropist: { color: 'yellow', comp: false, exp: 'Base Game' }, reincarnator: { color: 'yellow', comp: false, exp: 'Base Game' }, remora: { color: 'yellow', comp: false, exp: 'Base Game' }, reserve: { color: 'green', comp: false, exp: 'Base Game' }, shadow: { color: 'yellow', comp: false, exp: 'Base Game' }, sorcerer: { color: 'green', comp: false, exp: 'Base Game' }, spiff: { color: 'green', comp: false, exp: 'Base Game' }, tick_tock: { color: 'yellow', comp: true, exp: 'Base Game' }, trader: { color: 'green', comp: false, exp: 'Base Game' }, tripler: { color: 'red', comp: false, exp: 'Base Game' }, vacuum: { color: 'green', comp: false, exp: 'Base Game' }, virus: { color: 'red', comp: false, exp: 'Base Game' }, void: { color: 'red', comp: false, exp: 'Base Game' }, vulch: { color: 'green', comp: false, exp: 'Base Game' }, warpish: { color: 'red', comp: false, exp: 'Base Game' }, warrior: { color: 'green', comp: true, exp: 'Base Game' }, will: { color: 'green', comp: false, exp: 'Base Game' }, zombie: { color: 'green', comp: false, exp: 'Base Game' },
            // --- COSMIC INCURSION (20) ---
            bully: { color: 'yellow', comp: false, exp: 'Cosmic Incursion' }, chronos: { color: 'yellow', comp: false, exp: 'Cosmic Incursion' }, cryo: { color: 'yellow', comp: true, exp: 'Cosmic Incursion' }, deuce: { color: 'yellow', comp: true, exp: 'Cosmic Incursion' }, disease: { color: 'red', comp: false, exp: 'Cosmic Incursion' }, ethic: { color: 'green', comp: false, exp: 'Cosmic Incursion' }, fungus: { color: 'yellow', comp: true, exp: 'Cosmic Incursion' }, fury: { color: 'green', comp: true, exp: 'Cosmic Incursion' }, genius: { color: 'red', comp: false, exp: 'Cosmic Incursion' }, ghoul: { color: 'red', comp: false, exp: 'Cosmic Incursion' }, guerrilla: { color: 'green', comp: false, exp: 'Cosmic Incursion' }, leviathan: { color: 'yellow', comp: true, exp: 'Cosmic Incursion' }, locust: { color: 'yellow', comp: true, exp: 'Cosmic Incursion' }, magician: { color: 'red', comp: false, exp: 'Cosmic Incursion' }, mercenary: { color: 'green', comp: false, exp: 'Cosmic Incursion' }, merchant: { color: 'yellow', comp: false, exp: 'Cosmic Incursion' }, plant: { color: 'red', comp: false, exp: 'Cosmic Incursion' }, seeker: { color: 'yellow', comp: false, exp: 'Cosmic Incursion' }, sniveler: { color: 'yellow', comp: false, exp: 'Cosmic Incursion' }, symbiote: { color: 'green', comp: true, exp: 'Cosmic Incursion' },
            // --- COSMIC CONFLICT (20) ---
            cavalry: { color: 'green', comp: false, exp: 'Cosmic Conflict' }, changeling: { color: 'green', comp: false, exp: 'Cosmic Conflict' }, empath: { color: 'green', comp: false, exp: 'Cosmic Conflict' }, filth: { color: 'red', comp: false, exp: 'Cosmic Conflict' }, glutton: { color: 'green', comp: false, exp: 'Cosmic Conflict' }, graviton: { color: 'yellow', comp: false, exp: 'Cosmic Conflict' }, industrialist: { color: 'yellow', comp: true, exp: 'Cosmic Conflict' }, invader: { color: 'yellow', comp: false, exp: 'Cosmic Conflict' }, lunatic: { color: 'yellow', comp: false, exp: 'Cosmic Conflict' }, mimic: { color: 'yellow', comp: false, exp: 'Cosmic Conflict' }, prophet: { color: 'red', comp: false, exp: 'Cosmic Conflict' }, relic: { color: 'red', comp: false, exp: 'Cosmic Conflict' }, saboteur: { color: 'red', comp: true, exp: 'Cosmic Conflict' }, sadist: { color: 'red', comp: false, exp: 'Cosmic Conflict' }, siren: { color: 'yellow', comp: false, exp: 'Cosmic Conflict' }, the_claw: { color: 'red', comp: true, exp: 'Cosmic Conflict' }, trickster: { color: 'green', comp: false, exp: 'Cosmic Conflict' }, visionary: { color: 'yellow', comp: false, exp: 'Cosmic Conflict' }, warhawk: { color: 'yellow', comp: false, exp: 'Cosmic Conflict' }, xenophile: { color: 'green', comp: false, exp: 'Cosmic Conflict' },
            // --- COSMIC ALLIANCE (20) ---
            animal: { color: 'yellow', comp: false, exp: 'Cosmic Alliance' }, bandit: { color: 'red', comp: false, exp: 'Cosmic Alliance' }, butler: { color: 'yellow', comp: false, exp: 'Cosmic Alliance' }, chrysalis: { color: 'red', comp: true, exp: 'Cosmic Alliance' }, crystal: { color: 'yellow', comp: false, exp: 'Cosmic Alliance' }, cyborg: { color: 'yellow', comp: true, exp: 'Cosmic Alliance' }, extortionist: { color: 'yellow', comp: false, exp: 'Cosmic Alliance' }, general: { color: 'green', comp: false, exp: 'Cosmic Alliance' }, gorgon: { color: 'red', comp: false, exp: 'Cosmic Alliance' }, horde: { color: 'red', comp: true, exp: 'Cosmic Alliance' }, lightning: { color: 'yellow', comp: true, exp: 'Cosmic Alliance' }, poison: { color: 'red', comp: false, exp: 'Cosmic Alliance' }, pygmy: { color: 'green', comp: true, exp: 'Cosmic Alliance' }, reborn: { color: 'green', comp: false, exp: 'Cosmic Alliance' }, remote: { color: 'red', comp: true, exp: 'Cosmic Alliance' }, sapient: { color: 'green', comp: true, exp: 'Cosmic Alliance' }, schizoid: { color: 'red', comp: true, exp: 'Cosmic Alliance' }, skeptic: { color: 'yellow', comp: false, exp: 'Cosmic Alliance' }, sting: { color: 'yellow', comp: false, exp: 'Cosmic Alliance' }, winner: { color: 'yellow', comp: false, exp: 'Cosmic Alliance' },
            // --- COSMIC STORM (25) ---
            arcade: { color: 'yellow', comp: true, exp: 'Cosmic Storm' }, brute: { color: 'yellow', comp: false, exp: 'Cosmic Storm' }, bulwark: { color: 'green', comp: false, exp: 'Cosmic Storm' }, converter: { color: 'yellow', comp: false, exp: 'Cosmic Storm' }, coordinator: { color: 'yellow', comp: false, exp: 'Cosmic Storm' }, dervish: { color: 'yellow', comp: false, exp: 'Cosmic Storm' }, grumpus: { color: 'yellow', comp: false, exp: 'Cosmic Storm' }, mouth: { color: 'red', comp: true, exp: 'Cosmic Storm' }, neighbor: { color: 'green', comp: false, exp: 'Cosmic Storm' }, outlaw: { color: 'green', comp: false, exp: 'Cosmic Storm' }, patriot: { color: 'yellow', comp: false, exp: 'Cosmic Storm' }, phantasm: { color: 'green', comp: false, exp: 'Cosmic Storm' }, roach: { color: 'red', comp: true, exp: 'Cosmic Storm' }, scavenger: { color: 'yellow', comp: false, exp: 'Cosmic Storm' }, sloth: { color: 'yellow', comp: true, exp: 'Cosmic Storm' }, sneak: { color: 'yellow', comp: false, exp: 'Cosmic Storm' }, squee: { color: 'red', comp: false, exp: 'Cosmic Storm' }, swindler: { color: 'red', comp: true, exp: 'Cosmic Storm' }, sycophant: { color: 'yellow', comp: true, exp: 'Cosmic Storm' }, tide: { color: 'yellow', comp: true, exp: 'Cosmic Storm' }, tyrant: { color: 'red', comp: true, exp: 'Cosmic Storm' }, vox: { color: 'green', comp: false, exp: 'Cosmic Storm' }, worm: { color: 'yellow', comp: false, exp: 'Cosmic Storm' }, wormhole: { color: 'yellow', comp: false, exp: 'Cosmic Storm' },
            // --- COSMIC DOMINION (30) ---
            ace: { color: 'red', comp: false, exp: 'Cosmic Dominion' }, alchemist: { color: 'yellow', comp: false, exp: 'Cosmic Dominion' }, angler: { color: 'yellow', comp: false, exp: 'Cosmic Dominion' }, aristocrat: { color: 'red', comp: false, exp: 'Cosmic Dominion' }, bride: { color: 'yellow', comp: false, exp: 'Cosmic Dominion' }, daredevil: { color: 'yellow', comp: false, exp: 'Cosmic Dominion' }, diplomat: { color: 'yellow', comp: false, exp: 'Cosmic Dominion' }, doppelganger: { color: 'red', comp: false, exp: 'Cosmic Dominion' }, engineer: { color: 'yellow', comp: true, exp: 'Cosmic Dominion' }, explorer: { color: 'yellow', comp: true, exp: 'Cosmic Dominion' }, greenhorn: { color: 'green', comp: false, exp: 'Cosmic Dominion' }, host: { color: 'yellow', comp: true, exp: 'Cosmic Dominion' }, joker: { color: 'red', comp: true, exp: 'Cosmic Dominion' }, judge: { color: 'red', comp: false, exp: 'Cosmic Dominion' }, laser: { color: 'green', comp: false, exp: 'Cosmic Dominion' }, lizard: { color: 'green', comp: true, exp: 'Cosmic Dominion' }, love: { color: 'yellow', comp: false, exp: 'Cosmic Dominion' }, mesmer: { color: 'red', comp: false, exp: 'Cosmic Dominion' }, mirage: { color: 'green', comp: false, exp: 'Cosmic Dominion' }, muckraker: { color: 'yellow', comp: false, exp: 'Cosmic Dominion' }, pentaform: { color: 'red', comp: true, exp: 'Cosmic Dominion' }, pickpocket: { color: 'green', comp: false, exp: 'Cosmic Dominion' }, pirate: { color: 'yellow', comp: true, exp: 'Cosmic Dominion' }, quartermaster: { color: 'yellow', comp: false, exp: 'Cosmic Dominion' }, reactor: { color: 'red', comp: true, exp: 'Cosmic Dominion' }, tourist: { color: 'yellow', comp: true, exp: 'Cosmic Dominion' }, usurper: { color: 'yellow', comp: false, exp: 'Cosmic Dominion' }, voyager: { color: 'yellow', comp: false, exp: 'Cosmic Dominion' }, whirligig: { color: 'green', comp: false, exp: 'Cosmic Dominion' }, yin_yang: { color: 'yellow', comp: true, exp: 'Cosmic Dominion' },
            // --- COSMIC EONS (30) ---
            ai: { color: 'red', comp: true, exp: 'Cosmic Eons' }, alien: { color: 'red', comp: true, exp: 'Cosmic Eons' }, anarchist: { color: 'red', comp: true, exp: 'Cosmic Eons' }, architect: { color: 'red', comp: false, exp: 'Cosmic Eons' }, assistant: { color: 'yellow', comp: true, exp: 'Cosmic Eons' }, bleeding_heart: { color: 'green', comp: false, exp: 'Cosmic Eons' }, cloak: { color: 'red', comp: false, exp: 'Cosmic Eons' }, coward: { color: 'yellow', comp: false, exp: 'Cosmic Eons' }, crusher: { color: 'yellow', comp: true, exp: 'Cosmic Eons' }, emperor: { color: 'yellow', comp: true, exp: 'Cosmic Eons' }, evil_twin: { color: 'red', comp: true, exp: 'Cosmic Eons' }, fire_dancer: { color: 'yellow', comp: true, exp: 'Cosmic Eons' }, hunger: { color: 'green', comp: false, exp: 'Cosmic Eons' }, hypochondriac: { color: 'yellow', comp: true, exp: 'Cosmic Eons' }, klutz: { color: 'yellow', comp: false, exp: 'Cosmic Eons' }, maven: { color: 'red', comp: true, exp: 'Cosmic Eons' }, moocher: { color: 'red', comp: true, exp: 'Cosmic Eons' }, multitude: { color: 'green', comp: true, exp: 'Cosmic Eons' }, nanny: { color: 'yellow', comp: true, exp: 'Cosmic Eons' }, nightmare: { color: 'red', comp: true, exp: 'Cosmic Eons' }, oligarch: { color: 'red', comp: true, exp: 'Cosmic Eons' }, pack_rat: { color: 'yellow', comp: false, exp: 'Cosmic Eons' }, particle: { color: 'red', comp: true, exp: 'Cosmic Eons' }, peddler: { color: 'red', comp: true, exp: 'Cosmic Eons' }, perfectionist: { color: 'green', comp: true, exp: 'Cosmic Eons' }, porcupine: { color: 'yellow', comp: false, exp: 'Cosmic Storm' }, pretender: { color: 'red', comp: false, exp: 'Cosmic Eons' }, sheriff: { color: 'yellow', comp: true, exp: 'Cosmic Eons' }, surgeon: { color: 'yellow', comp: true, exp: 'Cosmic Eons' }, the_cult: { color: 'red', comp: true, exp: 'Cosmic Eons' }, tortoise: { color: 'red', comp: true, exp: 'Cosmic Eons' },
            // --- COSMIC ODYSSEY (30) ---
            assessor: { color: 'green', comp: true, exp: 'Cosmic Odyssey' }, aura: { color: 'green', comp: true, exp: 'Cosmic Odyssey' }, boomerang: { color: 'red', comp: true, exp: 'Cosmic Odyssey' }, booster: { color: 'green', comp: false, exp: 'Cosmic Odyssey' }, bubble: { color: 'yellow', comp: false, exp: 'Cosmic Odyssey' }, cosmos: { color: 'red', comp: true, exp: 'Cosmic Odyssey' }, decoy: { color: 'green', comp: true, exp: 'Cosmic Odyssey' }, delegator: { color: 'yellow', comp: false, exp: 'Cosmic Odyssey' }, dragon: { color: 'yellow', comp: true, exp: 'Cosmic Odyssey' }, extractor: { color: 'green', comp: false, exp: 'Cosmic Odyssey' }, force: { color: 'red', comp: false, exp: 'Cosmic Odyssey' }, geek: { color: 'green', comp: true, exp: 'Cosmic Odyssey' }, gremlin: { color: 'yellow', comp: true, exp: 'Cosmic Odyssey' }, guardian: { color: 'green', comp: false, exp: 'Cosmic Odyssey' }, hurtz: { color: 'yellow', comp: true, exp: 'Cosmic Odyssey' }, inferno: { color: 'yellow', comp: true, exp: 'Cosmic Odyssey' }, insect: { color: 'yellow', comp: true, exp: 'Cosmic Odyssey' }, lemming: { color: 'yellow', comp: false, exp: 'Cosmic Odyssey' }, lloyd: { color: 'green', comp: true, exp: 'Cosmic Odyssey' }, magnet: { color: 'green', comp: false, exp: 'Cosmic Odyssey' }, negator: { color: 'green', comp: true, exp: 'Cosmic Odyssey' }, phantom: { color: 'yellow', comp: true, exp: 'Cosmic Odyssey' }, silencer: { color: 'red', comp: true, exp: 'Cosmic Odyssey' }, tentacle: { color: 'green', comp: false, exp: 'Cosmic Odyssey' }, the_meek: { color: 'red', comp: false, exp: 'Cosmic Odyssey' }, throwback: { color: 'red', comp: false, exp: 'Cosmic Odyssey' }, vector: { color: 'green', comp: true, exp: 'Cosmic Odyssey' }, witch: { color: 'red', comp: true, exp: 'Cosmic Odyssey' }, wrack: { color: 'yellow', comp: false, exp: 'Cosmic Odyssey' }, zilch: { color: 'red', comp: true, exp: 'Cosmic Odyssey' },
            // --- ALTERNATE TIMELINE (12) ---
            brute_alternate: { color: 'yellow', comp: false, exp: 'Cosmic Odyssey' }, daredevil_alternate: { color: 'yellow', comp: false, exp: 'Cosmic Odyssey' }, demon_alternate: { color: 'yellow', comp: true, exp: 'Cosmic Odyssey' }, grumpus_alternate: { color: 'yellow', comp: false, exp: 'Cosmic Odyssey' }, locust_alternate: { color: 'yellow', comp: true, exp: 'Cosmic Odyssey' }, masochist_alternate: { color: 'red', comp: false, exp: 'Cosmic Odyssey' }, micron_alternate: { color: 'green', comp: false, exp: 'Cosmic Odyssey' }, perfectionist_alternate: { color: 'green', comp: true, exp: 'Cosmic Odyssey' }, sadist_alternate: { color: 'red', comp: true, exp: 'Cosmic Odyssey' }, schizoid_alternate: { color: 'red', comp: true, exp: 'Cosmic Odyssey' }, void_alternate: { color: 'red', comp: true, exp: 'Cosmic Odyssey' }, zombie_alternate: { color: 'green', comp: false, exp: 'Cosmic Odyssey' }
        };

        const essenceAliens = [
            'alien', 'anarchist', 'assistant', 'nanny', 'nightmare',
            'oligarch', 'sheriff', 'cosmos', 'negator',
            'witch', 'zilch', 'schizoid_alternate'
        ];

        function enrichAlienData() {
            window.aliensData.forEach(alien => {
                let meta = alienMetadata[alien.id];
                // Tenta busca normalizada caso n√£o encontre direto
                if (!meta) {
                    const key = Object.keys(alienMetadata).find(k => k.toLowerCase() === alien.id.toLowerCase());
                    if (key) meta = alienMetadata[key];
                }

                if (meta) {
                    alien.alert = meta.color;
                    alien.hasComponents = meta.comp;
                    alien.expansion = meta.exp;
                } else {
                    // Fallback para Base Game e Verde se n√£o achar
                    if (!alien.alert) alien.alert = 'green';
                    if (alien.hasComponents === undefined) alien.hasComponents = false;
                    if (!alien.expansion) alien.expansion = 'Base Game';
                }

                // Detecta Setup no texto se n√£o tiver sido definido
                if (alien.hasSetup === undefined) {
                    const ptPower = alien.power.pt || "";
                    const enPower = alien.power.en || "";
                    if (ptPower.includes("Prepara√ß√£o de Jogo:") || ptPower.includes("Game Setup:") || enPower.includes("Game Setup:")) {
                        alien.hasSetup = true;
                    } else {
                        alien.hasSetup = false;
                    }
                }

                if (essenceAliens.includes(alien.id.toLowerCase())) {
                    alien.hasEssence = true;
                } else {
                    alien.hasEssence = false;
                }
            });
        }


        // --- LIKE/DISLIKE LOGIC ---
        function getLikeState(alienId) {
            return localStorage.getItem(`alien_state_${alienId}`);
        }

        function setLikeState(alienId, state) {
            if (state) {
                localStorage.setItem(`alien_state_${alienId}`, state);
            } else {
                localStorage.removeItem(`alien_state_${alienId}`);
            }
            // Re-render to update UI (could be optimized to just update class)
            // But since we might be filtering, full re-render is safer/easier
            filterCurrentView();
        }

        function toggleLike(alienId) {
            const currentState = getLikeState(alienId);
            if (currentState === 'like') {
                setLikeState(alienId, null);
            } else {
                setLikeState(alienId, 'like');
            }
        }

        function toggleDislike(alienId) {
            const currentState = getLikeState(alienId);
            if (currentState === 'dislike') {
                setLikeState(alienId, null);
            } else {
                setLikeState(alienId, 'dislike');
            }
        }

        let currentVariant = 'aliens';

        function toggleMenu() {
            document.getElementById('sideMenu').classList.toggle('open');
            document.getElementById('overlay').classList.toggle('show');
        }

        function closeMenu() {
            document.getElementById('sideMenu').classList.remove('open');
            document.getElementById('overlay').classList.remove('show');
        }

        function toggleLanguage() {
            currentLang = currentLang === 'pt' ? 'en' : 'pt';
            const btn = document.getElementById('langBtn');
            const input = document.getElementById('searchInput');

            const labelAlert = document.getElementById('labelAlert');
            const labelSetup = document.getElementById('labelSetup');
            const labelTokens = document.getElementById('labelTokens');

            if (currentLang === 'pt') {
                btn.innerText = "üá∫üá∏ English";
                input.placeholder = "Buscar...";
                labelAlert.innerText = "N√≠vel:";
                labelSetup.innerText = "Prepara√ß√£o";
                labelTokens.innerText = "Fichas";
                if (document.getElementById('labelEssence')) document.getElementById('labelEssence').innerText = "Ess√™ncia";
                if (document.getElementById('labelPrefs')) document.getElementById('labelPrefs').innerText = "Prefer√™ncias:";
                if (document.getElementById('menuCampaign')) document.getElementById('menuCampaign').innerText = "Campanha";
            } else {
                btn.innerText = "üáßüá∑ Portugu√™s";
                input.placeholder = "Search...";
                labelAlert.innerText = "Level:";
                labelSetup.innerText = "Setup";
                labelTokens.innerText = "Tokens";
                if (document.getElementById('labelEssence')) document.getElementById('labelEssence').innerText = "Essence";
                if (document.getElementById('labelPrefs')) document.getElementById('labelPrefs').innerText = "Preferences:";
                if (document.getElementById('menuCampaign')) document.getElementById('menuCampaign').innerText = "Campaign";
            }
            updateExpansionCounts();
            updateExpansionCounts();
            updateView();
        }

        function selectVariant(variant) {
            currentVariant = variant;
            closeMenu();

            // Update active state in menu
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
                // Simple check for active class
                if (item.innerText.toLowerCase().includes(variant === 'techs' ? 'technology' : variant)) {
                    item.classList.add('active');
                } else if (variant === 'stations' && item.innerText.toLowerCase().includes('stations')) {
                    item.classList.add('active');
                }
            });

            updateView();
        }

        function updateView() {
            const alienGrid = document.getElementById('alienGrid');
            const hazardGrid = document.getElementById('hazardGrid');
            const techGrid = document.getElementById('techGrid');
            const stationGrid = document.getElementById('stationGrid');
            const moonGrid = document.getElementById('moonGrid');
            const evolutionGrid = document.getElementById('evolutionGrid');
            const luxGrid = document.getElementById('luxGrid');
            const alienFilters = document.getElementById('alienFilters');
            const expansionFilter = document.getElementById('expansionFilter');
            const searchInput = document.getElementById('searchInput');
            const resultCount = document.getElementById('resultCount');

            // Hide all first
            alienGrid.style.display = 'none';
            hazardGrid.style.display = 'none';
            techGrid.style.display = 'none';
            if (stationGrid) stationGrid.style.display = 'none';
            if (moonGrid) moonGrid.style.display = 'none';
            if (evolutionGrid) evolutionGrid.style.display = 'none';
            if (luxGrid) luxGrid.style.display = 'none';
            alienFilters.style.display = 'none';

            // Show search for all, hide expansion by default
            expansionFilter.style.display = 'none';
            searchInput.style.display = 'block';
            document.querySelector('.search-wrapper').style.display = 'flex';
            resultCount.innerText = '';

            if (currentVariant === 'aliens') {
                alienGrid.style.display = 'grid';
                alienFilters.style.display = 'flex';
                expansionFilter.style.display = 'block';
                filterAliens();
            } else if (currentVariant === 'hazards') {
                hazardGrid.style.display = 'grid';
                renderHazards();
            } else if (currentVariant === 'techs') {
                techGrid.style.display = 'grid';
                renderTechs();
            } else if (currentVariant === 'stations') {
                document.getElementById('stationGrid').style.display = 'grid';
                renderStations();
            } else if (currentVariant === 'moons') {
                document.getElementById('moonGrid').style.display = 'grid';
                renderMoons();
            } else if (currentVariant === 'evolutions') {
                document.getElementById('evolutionGrid').style.display = 'grid';
                renderEvolutions();
            } else if (currentVariant === 'lux') {
                document.getElementById('luxGrid').style.display = 'grid';
                renderLux();
            }
        }

        function filterCurrentView() {
            const textTerm = document.getElementById('searchInput').value;
            const clearBtn = document.getElementById('clearSearch');

            if (textTerm.length > 0) {
                clearBtn.style.display = 'block';
            } else {
                clearBtn.style.display = 'none';
            }

            if (currentVariant === 'aliens') {
                filterAliens();
            } else {
                updateView();
            }
        }

        function renderHazards() {
            const grid = document.getElementById('hazardGrid');
            grid.innerHTML = '';

            if (!window.hazardsData) return;

            const searchTerm = document.getElementById('searchInput').value.toLowerCase();

            const filtered = window.hazardsData.filter(item => {
                const titlePT = (item.title.pt || "").toLowerCase();
                const titleEN = (item.title.en || "").toLowerCase();
                const matchesText = titlePT.includes(searchTerm) || titleEN.includes(searchTerm);
                return matchesText;
            });

            filtered.forEach(hazard => {
                const card = document.createElement('div');
                card.className = 'card';

                let title = hazard.title[currentLang];
                if (currentLang === 'pt' && hazard.title.en) {
                    title = `${hazard.title.pt} <span style="color: #666; font-size: 0.8em;">/ ${hazard.title.en}</span>`;
                }

                const text = hazard.text[currentLang];
                const type = hazard.type; // Permanent, Hazard, etc.
                const expansion = hazard.expansion;

                // Determine border color based on type (optional)
                let borderColor = 'var(--border)';
                if (type === 'Permanent') borderColor = 'var(--c-purple)';
                else if (type === 'Hazard') borderColor = 'var(--c-yellow)';
                else if (type === 'SemiPermanent') borderColor = 'var(--c-red)';

                card.style.borderColor = borderColor;

                card.innerHTML = `
                    <div class="card-content">
                        <div class="power-summary" style="color: ${borderColor}">${title}</div>
                        <div class="aka-info">${type}</div>
                        <div class="power-block">
                            ${text.replace(/\n/g, '<br>')}
                        </div>
                        <div class="expansion-tag" style="position: relative; bottom: auto; left: auto; margin-top: 10px; display: inline-block;">${expansion}</div>
                    </div>
                `;
                grid.appendChild(card);
            });
            const countText = currentLang === 'pt' ? 'Hazards encontrados' : 'Hazards found';
            document.getElementById('resultCount').innerHTML = `${countText}: <span>${filtered.length}</span>`;
        }

        function renderTechs() {
            const grid = document.getElementById('techGrid');
            grid.innerHTML = '';

            if (!window.techsData) return;

            const searchTerm = document.getElementById('searchInput').value.toLowerCase();

            const filtered = window.techsData.filter(item => {
                const titlePT = (item.title.pt || "").toLowerCase();
                const titleEN = (item.title.en || "").toLowerCase();
                const matchesText = titlePT.includes(searchTerm) || titleEN.includes(searchTerm);
                return matchesText;
            });

            filtered.forEach(tech => {
                const card = document.createElement('div');
                card.className = 'card';

                let title = tech.title[currentLang];
                if (currentLang === 'pt' && tech.title.en) {
                    title = `${tech.title.pt} <span style="color: #666; font-size: 0.8em;">/ ${tech.title.en}</span>`;
                }
                const text = tech.text[currentLang];
                const type = tech.type;
                const expansion = tech.expansion;

                // Techs usually have a specific color, maybe blue or grey. Using default border for now or specific if needed.
                let borderColor = 'var(--c-blue)';
                if (type === 'Haz-Tech') borderColor = 'var(--c-yellow)';
                else if (type === 'Mili-Tech') borderColor = 'var(--c-red)';

                card.style.borderColor = borderColor;

                card.innerHTML = `
                    <div class="card-content">
                        <div class="power-summary" style="color: ${borderColor}">${title}</div>
                        <div class="aka-info">${type}</div>
                        <div class="power-block">
                            ${text.replace(/\n/g, '<br>')}
                        </div>
                        <div class="expansion-tag" style="position: relative; bottom: auto; left: auto; margin-top: 10px; display: inline-block;">${expansion}</div>
                    </div>
                `;
                grid.appendChild(card);
            });
            const countText = currentLang === 'pt' ? 'Techs encontradas' : 'Techs found';
            document.getElementById('resultCount').innerHTML = `${countText}: <span>${filtered.length}</span>`;
        }

        function renderStations() {
            const grid = document.getElementById('stationGrid');
            grid.innerHTML = '';

            if (!window.stationsData) return;

            const searchTerm = document.getElementById('searchInput').value.toLowerCase();

            const filtered = window.stationsData.filter(item => {
                const titlePT = (item.title.pt || "").toLowerCase();
                const titleEN = (item.title.en || "").toLowerCase();
                const matchesText = titlePT.includes(searchTerm) || titleEN.includes(searchTerm);
                return matchesText;
            });

            filtered.forEach(station => {
                const card = document.createElement('div');
                card.className = 'card';

                let title = station.title[currentLang];
                if (currentLang === 'pt' && station.title.en) {
                    title = `${station.title.pt} <span style="color: #666; font-size: 0.8em;">/ ${station.title.en}</span>`;
                }
                const text = station.text[currentLang];
                const type = station.type;
                const expansion = station.expansion;

                // Stations color
                let borderColor = '#0ea5e9'; // Sky blueish

                card.style.borderColor = borderColor;

                card.innerHTML = `
                    <div class="card-content">
                        <div class="power-summary" style="color: ${borderColor}">${title}</div>
                        <div class="aka-info">${type}</div>
                        <div class="power-block">
                            ${text.replace(/\n/g, '<br>')}
                        </div>
                        <div class="expansion-tag" style="position: relative; bottom: auto; left: auto; margin-top: 10px; display: inline-block;">${expansion}</div>
                    </div>
                `;
                grid.appendChild(card);
            });
            const countText = currentLang === 'pt' ? 'Esta√ß√µes encontradas' : 'Stations found';
            document.getElementById('resultCount').innerHTML = `${countText}: <span>${filtered.length}</span>`;
        }

        function renderMoons() {
            const grid = document.getElementById('moonGrid');
            grid.innerHTML = '';

            if (!window.moonsData) return;

            const searchTerm = document.getElementById('searchInput').value.toLowerCase();

            const filtered = window.moonsData.filter(item => {
                const titlePT = (item.title.pt || "").toLowerCase();
                const titleEN = (item.title.en || "").toLowerCase();
                const matchesText = titlePT.includes(searchTerm) || titleEN.includes(searchTerm);
                return matchesText;
            });

            filtered.forEach(moon => {
                const card = document.createElement('div');
                card.className = 'card';

                let title = moon.title[currentLang];
                if (currentLang === 'pt' && moon.title.en) {
                    title = `${moon.title.pt} <span style="color: #666; font-size: 0.8em;">/ ${moon.title.en}</span>`;
                }
                const text = moon.text[currentLang];
                const type = moon.type;
                const expansion = moon.expansion;

                let borderColor = '#a855f7'; // Purpleish

                card.style.borderColor = borderColor;

                card.innerHTML = `
                    <div class="card-content">
                        <div class="power-summary" style="color: ${borderColor}">${title}</div>
                        <div class="aka-info">${type}</div>
                        <div class="power-block">
                            ${text.replace(/\n/g, '<br>')}
                        </div>
                        <div class="expansion-tag" style="position: relative; bottom: auto; left: auto; margin-top: 10px; display: inline-block;">${expansion}</div>
                    </div>
                `;
                grid.appendChild(card);
            });
            const countText = currentLang === 'pt' ? 'Luas encontradas' : 'Moons found';
            document.getElementById('resultCount').innerHTML = `${countText}: <span>${filtered.length}</span>`;
        }

        function renderEvolutions() {
            const grid = document.getElementById('evolutionGrid');
            grid.innerHTML = '';

            if (!window.evolutionsData) return;

            const searchTerm = document.getElementById('searchInput').value.toLowerCase();

            const filtered = window.evolutionsData.filter(item => {
                const titlePT = (item.title.pt || "").toLowerCase();
                const titleEN = (item.title.en || "").toLowerCase();
                const matchesText = titlePT.includes(searchTerm) || titleEN.includes(searchTerm);
                return matchesText;
            });

            filtered.forEach(evo => {
                const card = document.createElement('div');
                card.className = 'card';

                let title = evo.title[currentLang];
                if (currentLang === 'pt' && evo.title.en) {
                    title = `${evo.title.pt} <span style="color: #666; font-size: 0.8em;">/ ${evo.title.en}</span>`;
                }
                const text = evo.text[currentLang];
                const type = evo.type;
                const expansion = evo.expansion;

                let borderColor = '#22c55e'; // Greenish

                card.style.borderColor = borderColor;

                card.innerHTML = `
                    <div class="card-content">
                        <div class="power-summary" style="color: ${borderColor}">${title}</div>
                        <div class="aka-info">${type}</div>
                        <div class="power-block">
                            ${text.replace(/\n/g, '<br>')}
                        </div>
                        <div class="expansion-tag" style="position: relative; bottom: auto; left: auto; margin-top: 10px; display: inline-block;">${expansion}</div>
                    </div>
                `;
                grid.appendChild(card);
            });
            const countText = currentLang === 'pt' ? 'Evolu√ß√µes encontradas' : 'Evolutions found';
            document.getElementById('resultCount').innerHTML = `${countText}: <span>${filtered.length}</span>`;
        }

        function renderLux() {
            const grid = document.getElementById('luxGrid');
            grid.innerHTML = '';

            if (!window.luxData) return;

            const searchTerm = document.getElementById('searchInput').value.toLowerCase();

            const filtered = window.luxData.filter(item => {
                const titlePT = (item.title.pt || "").toLowerCase();
                const titleEN = (item.title.en || "").toLowerCase();
                const matchesText = titlePT.includes(searchTerm) || titleEN.includes(searchTerm);
                return matchesText;
            });

            filtered.forEach(lux => {
                const card = document.createElement('div');
                card.className = 'card';

                let title = lux.title[currentLang];
                if (currentLang === 'pt' && lux.title.en) {
                    title = `${lux.title.pt} <span style="color: #666; font-size: 0.8em;">/ ${lux.title.en}</span>`;
                }
                const text = lux.text[currentLang];
                const type = lux.type;
                const expansion = lux.expansion;

                let borderColor = '#f59e0b'; // Amber/Gold

                card.style.borderColor = borderColor;

                card.innerHTML = `
                    <div class="card-content">
                        <div class="power-summary" style="color: ${borderColor}">${title}</div>
                        <div class="aka-info">${type}</div>
                        <div class="power-block">
                            ${text.replace(/\n/g, '<br>')}
                        </div>
                        <div class="expansion-tag" style="position: relative; bottom: auto; left: auto; margin-top: 10px; display: inline-block;">${expansion}</div>
                    </div>
                `;
                grid.appendChild(card);
            });
            const countText = currentLang === 'pt' ? 'Lux encontrados' : 'Lux found';
            document.getElementById('resultCount').innerHTML = `${countText}: <span>${filtered.length}</span>`;
        }

        function toggleFlare(btn) {
            const flareText = btn.nextElementSibling;
            flareText.classList.toggle('show');
            const isPT = currentLang === 'pt';
            if (flareText.classList.contains('show')) {
                btn.innerText = isPT ? 'Esconder Flare' : 'Hide Flare';
            } else {
                btn.innerText = isPT ? 'Ver Flare' : 'View Flare';
            }
        }

        function toggleEssence(btn) {
            const essenceText = btn.nextElementSibling;
            essenceText.classList.toggle('show');
            const isPT = currentLang === 'pt';
            if (essenceText.classList.contains('show')) {
                btn.innerText = isPT ? 'Esconder Essence Cards' : 'Hide Essence Cards';
            } else {
                btn.innerText = isPT ? 'Ver Essence Cards' : 'View Essence Cards';
            }
        }

        function getAlienImage(alienId) {
            const key = alienId.toUpperCase();
            // Tenta carregar do mapa de imagens
            if (window.alienImages && window.alienImages[key]) {
                return window.alienImages[key];
            }
            // Fallback para imagem local se n√£o estiver no mapa
            return 'img/vazio.jpg';
        }

        function toggleHistory(btn) {
            const text = btn.nextElementSibling;
            text.classList.toggle('show');
            btn.innerText = text.classList.contains('show') ?
                (currentLang === 'pt' ? 'Esconder Hist√≥ria' : 'Hide History') :
                (currentLang === 'pt' ? 'Ver Hist√≥ria' : 'Show History');
        }

        function updateExpansionCounts() {
            const counts = {};
            let total = 0;
            window.aliensData.forEach(alien => {
                total++;
                const exp = alien.expansion;
                counts[exp] = (counts[exp] || 0) + 1;
                if (alien.flare) {
                    // counts['flares'] = (counts['flares'] || 0) + 1;
                }
            });

            const select = document.getElementById('expansionFilter');
            const allText = currentLang === 'pt' ? "Todas as Expans√µes" : "All Expansions";
            select.options[0].text = `${allText} (${total})`;

            for (let i = 1; i < select.options.length; i++) {
                const opt = select.options[i];
                const key = opt.value;
                const count = counts[key] || 0;
                let baseName = key;

                opt.text = `${baseName} (${count})`;
            }
        }

        function clearSearch() {
            const input = document.getElementById('searchInput');
            input.value = '';
            input.focus();
            filterCurrentView();
        }

        function createTimingHtml(timingObj) {
            if (!timingObj) return '';

            const player = timingObj.player[currentLang];
            const choice = timingObj.choice[currentLang];
            const phases = timingObj.phases;

            const phaseNames = {
                startTurn: currentLang === 'pt' ? 'In√≠cio' : 'Start',
                regroup: currentLang === 'pt' ? 'Reagrupar' : 'Regroup',
                destiny: currentLang === 'pt' ? 'Destino' : 'Destiny',
                launch: currentLang === 'pt' ? 'Lan√ßar' : 'Launch',
                alliance: currentLang === 'pt' ? 'Alian√ßa' : 'Alliance',
                planning: currentLang === 'pt' ? 'Planejar' : 'Planning',
                reveal: currentLang === 'pt' ? 'Revelar' : 'Reveal',
                resolution: currentLang === 'pt' ? 'Resolu√ß√£o' : 'Resolution'
            };

            let phasesHtml = '';
            for (const [key, label] of Object.entries(phaseNames)) {
                const isActive = phases[key] ? ' active' : '';
                phasesHtml += `<div class="phase-tag${isActive}">${label}</div>`;
            }

            const usageLabel = currentLang === 'pt' ? 'Uso:' : 'Usage:';
            const choiceLabel = currentLang === 'pt' ? 'Tipo:' : 'Type:';

            return `
                <div class="timing-block">
                    <div class="timing-row">
                        <span class="timing-header">${usageLabel}</span>
                        <span class="timing-value">${player}</span>
                    </div>
                    <div class="timing-row">
                        <span class="timing-header">${choiceLabel}</span>
                        <span class="timing-value">${choice}</span>
                    </div>
                    <div class="phases-grid">
                        ${phasesHtml}
                    </div>
                </div>
            `;
        }

        function filterAliens() {
            const textTerm = document.getElementById('searchInput').value.toLowerCase();

            const clearBtn = document.getElementById('clearSearch');
            if (textTerm.length > 0) {
                clearBtn.style.display = 'block';
            } else {
                clearBtn.style.display = 'none';
            }

            const expansionTerm = document.getElementById('expansionFilter').value;

            const showGreen = document.querySelector('.cb-green').checked;
            const showYellow = document.querySelector('.cb-yellow').checked;
            const showRed = document.querySelector('.cb-red').checked;

            const requireSetup = document.getElementById('checkSetup').checked;
            const requireComponents = document.getElementById('checkComponents').checked;
            const requireEssence = document.getElementById('checkEssence').checked;

            const showLiked = document.getElementById('checkLiked').checked;
            const showDisliked = document.getElementById('checkDisliked').checked;

            const grid = document.getElementById('alienGrid');
            const resultCount = document.getElementById('resultCount');
            grid.innerHTML = '';

            const sortedAliens = window.aliensData.sort((a, b) => {
                const nameA = a.name[currentLang] || a.name.pt;
                const nameB = b.name[currentLang] || b.name.pt;
                return nameA.localeCompare(nameB);
            });

            const filtered = sortedAliens.filter(alien => {
                const namePT = (alien.name.pt || "").toLowerCase();
                const nameEN = (alien.name.en || "").toLowerCase();
                const aka = (alien.aka || "").toLowerCase();
                const id = (alien.id || "").toLowerCase();

                const matchesText = namePT.includes(textTerm) ||
                    nameEN.includes(textTerm) ||
                    aka.includes(textTerm) ||
                    id.includes(textTerm);

                let matchesExpansion = false;
                if (expansionTerm === 'all') {
                    matchesExpansion = true;
                } else {
                    matchesExpansion = alien.expansion === expansionTerm;
                }

                let matchesColor = false;
                if (alien.alert === 'green' && showGreen) matchesColor = true;
                if (alien.alert === 'yellow' && showYellow) matchesColor = true;
                if (alien.alert === 'red' && showRed) matchesColor = true;
                if (!alien.alert && showGreen) matchesColor = true;

                let matchesSetup = true;
                if (requireSetup && !alien.hasSetup) matchesSetup = false;

                let matchesComp = true;
                if (requireComponents && !alien.hasComponents) matchesComp = false;

                let matchesEssence = true;
                if (requireEssence && !alien.hasEssence) matchesEssence = false;

                if (id.includes('zombie')) {
                    console.log(`Checking ${id}: Text=${matchesText} (${textTerm}), Exp=${matchesExpansion} (${alien.expansion}), Color=${matchesColor} (${alien.alert}), Setup=${matchesSetup}, Comp=${matchesComp}, Essence=${matchesEssence}`);
                }

                const likeState = getLikeState(alien.id);
                let matchesPrefs = true;

                // Logic: 
                // If neither checked: show all
                // If Liked checked: show ONLY liked (unless Disliked also checked)
                // If Disliked checked: show ONLY disliked (unless Liked also checked)
                // If both checked: show Liked OR Disliked

                if (showLiked && !showDisliked) {
                    if (likeState !== 'like') matchesPrefs = false;
                } else if (!showLiked && showDisliked) {
                    if (likeState !== 'dislike') matchesPrefs = false;
                } else if (showLiked && showDisliked) {
                    if (likeState !== 'like' && likeState !== 'dislike') matchesPrefs = false;
                }

                return matchesText && matchesExpansion && matchesColor && matchesSetup && matchesComp && matchesEssence && matchesPrefs;
            });

            const foundText = currentLang === 'pt' ? 'encontrado(s)' : 'found';
            resultCount.innerHTML = `<span>${filtered.length}</span> alien(s) ${foundText}`;

            filtered.forEach(alien => {
                const card = document.createElement('div');
                card.className = 'card';

                // --- MODIFICA√á√ÉO AQUI ---
                const alienIdLower = alien.id.toLowerCase();
                // Verifica se √© um alternativo (_alternate) OU se √© o alien "throwback"
                const isSpecial = alienIdLower.includes('_alternate') || alienIdLower === 'throwback';
                // Aplica a classe alt-border se for qualquer um dos casos
                const borderClass = isSpecial ? ' alt-border' : '';
                // ------------------------    

                const imageUrl = getAlienImage(alien.id);
                // Sempre exibe t√≠tulo em ingl√™s conforme solicitado
                const name = alien.name.en || alien.name.pt;
                const summary = alien.summary[currentLang] || alien.summary.pt;
                const powerText = alien.power[currentLang] || alien.power.pt;
                const history = alien.history[currentLang] || alien.history.pt;

                let badgesHtml = '';
                let colorClass = '';
                if (alien.alert === 'green') colorClass = 'var(--c-green)';
                else if (alien.alert === 'yellow') colorClass = 'var(--c-yellow)';
                else if (alien.alert === 'red') colorClass = 'var(--c-red)';
                else colorClass = '#999';

                badgesHtml += `<div class="badge"><span class="alert-dot" style="background:${colorClass}"></span></div>`;
                if (alien.hasSetup) badgesHtml += `<div class="badge">‚öôÔ∏è</div>`;
                if (alien.hasComponents) badgesHtml += `<div class="badge">üì¶</div>`;
                if (alien.hasEssence) badgesHtml += `<div class="badge">‚ú®</div>`;

                // AKA L√≥gica: Se PT, mostra AKA ou Nome PT se diferente do EN
                let akaField = '';
                if (currentLang === 'pt') {
                    let akaText = '';
                    if (alien.aka) {
                        akaText = alien.aka;
                    } else if (alien.name.pt && alien.name.pt !== alien.name.en) {
                        akaText = alien.name.pt;
                    }

                    if (akaText) {
                        akaField = `<div class="aka-info">Tamb√©m conhecido como: <strong>${akaText}</strong></div>`;
                    }
                }

                let flareHtml = '';
                if (alien.flare) {
                    const wildText = alien.flare.wild[currentLang];
                    const superText = alien.flare.super[currentLang];
                    const btnText = currentLang === 'pt' ? 'Ver Flare' : 'View Flare';

                    const wildTimingHtml = alien.flare.wild.timing ? createTimingHtml(alien.flare.wild.timing) : '';
                    const superTimingHtml = alien.flare.super.timing ? createTimingHtml(alien.flare.super.timing) : '';

                    flareHtml = `
                    <button class="action-btn flare-btn" onclick="toggleFlare(this)">${btnText}</button>
                    <div class="expandable-text flare-text">
                        <span class="flare-title">Wild</span>
                        <p>${wildText}</p>
                        ${wildTimingHtml}
                        <div style="margin-top:10px;"></div>
                        <span class="flare-title">Super</span>
                        <p>${superText}</p>
                        ${superTimingHtml}
                    </div>
                `;
                }

                let essenceHtml = '';
                if (alien.essence) {
                    // Handle essence name which can be a string or object
                    let essenceName = alien.essence.name;
                    if (typeof essenceName === 'object') {
                        essenceName = essenceName[currentLang] || essenceName.pt || essenceName.en;
                    }

                    const essenceList = alien.essence.list;
                    const btnText = currentLang === 'pt' ? 'Ver Essence Cards' : 'View Essence Cards';

                    let cardsHtml = '';
                    for (const [key, cardData] of Object.entries(essenceList)) {
                        // Handle card name and body which can be strings or objects
                        let cardName = cardData.name;
                        if (typeof cardName === 'object') {
                            cardName = cardName[currentLang] || cardName.pt || cardName.en;
                        }

                        let cardBody = cardData.body;
                        if (typeof cardBody === 'object') {
                            cardBody = cardBody[currentLang] || cardBody.pt || cardBody.en;
                        }

                        cardsHtml += `
                            <div class="essence-card">
                                <span class="essence-title">#${key} ${cardName}</span>
                                <p>${cardBody}</p>
                            </div>
                        `;
                    }

                    essenceHtml = `
                    <button class="action-btn essence-btn" onclick="toggleEssence(this)" style="margin-top: 10px; background: #8b5cf6;">${btnText}</button>
                    <div class="expandable-text essence-text">
                        <div class="essence-header" style="font-weight: bold; margin-bottom: 10px; color: #8b5cf6;">${essenceName}</div>
                        ${cardsHtml}
                    </div>
                `;
                }

                const timingHtml = createTimingHtml(alien.timing);

                const likeState = getLikeState(alien.id);
                const likeActive = likeState === 'like' ? 'active' : '';
                const dislikeActive = likeState === 'dislike' ? 'active' : '';

                card.innerHTML = `
                    <div class="card-image-container${borderClass}">
                        <img src="${imageUrl}" class="card-image" alt="${name}" onerror="this.src='img/vazio.jpg'">
                        <div class="card-image-title">${name}</div>
                        <div class="badges-container">
                            ${badgesHtml}
                        </div>
                    </div>
                    <div class="card-content">
                        ${akaField}
                        <div class="power-summary">${summary}</div>
                        <div class="power-block">
                            ${powerText}
                        </div>
                        
                        ${timingHtml}
                        ${flareHtml}
                        ${essenceHtml}
                        
                        <button class="action-btn" onclick="toggleHistory(this)">${currentLang === 'pt' ? 'Ver Hist√≥ria' : 'Show History'}</button>
                        <div class="expandable-text history-text">
                            ${history}
                        </div>

                        <div class="like-dislike-container">
                            <button class="like-btn ${likeActive}" onclick="toggleLike('${alien.id}')" title="Like">üëç</button>
                            <button class="dislike-btn ${dislikeActive}" onclick="toggleDislike('${alien.id}')" title="Dislike">üëé</button>
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });


            if (filtered.length === 0) {
                grid.innerHTML = `<div style="color: #94a3b8; grid-column: 1/-1; text-align: center; padding: 40px; font-size: 1.2rem;">
                Nenhum alien encontrado. / No aliens found.
            </div>`;
            }
        }

        window.onload = function () {
            enrichAlienData();
            updateExpansionCounts();
            filterAliens();

            let lastScrollTop = 0;
            const header = document.querySelector('header');
            const floatBtn = document.getElementById('showFiltersBtn');

            window.addEventListener('scroll', function () {
                let scrollTop = window.pageYOffset || document.documentElement.scrollTop;

                if (scrollTop > 100) {
                    // Scrolling down past threshold - hide header, show button
                    if (!header.classList.contains('header-hidden')) {
                        header.classList.add('header-hidden');
                        floatBtn.classList.add('visible');
                    }
                } else {
                    // At top - show header, hide button
                    header.classList.remove('header-hidden');
                    floatBtn.classList.remove('visible');
                }
                lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
            });

            window.showHeader = function () {
                header.classList.remove('header-hidden');
                floatBtn.classList.remove('visible');
            };
        };
    </script>